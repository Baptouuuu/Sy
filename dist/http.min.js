/*! sy#1.1.1 - 2014-12-24 */
function namespace(a){var b=null,c=this;if("string"==typeof a)b=a.split(".");else{if(!(a instanceof Array&&a.length>0))return c;b=a}return c[b[0]]=c[b[0]]||{},a=b.shift(),namespace.call(c[a],b)}function objectSetter(a,b){var c="",d="",e=this,f=a.lastIndexOf(".");f>=0?(d=a.substr(f+1),c=a.substr(0,f),e=namespace.call(e,c)):d=a,e[d]=b}function objectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return c[a]}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?c[a[0]]:void 0;b=a}return a=b.shift(),objectGetter.call(c[a],b)}function capitalize(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function reflectedObjectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return getReflectedValue.call(c,a)}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?getReflectedValue.call(c,a[0]):void 0;b=a}return a=b.shift(),reflectedObjectGetter.call(getReflectedValue.call(c,a),b)}function getReflectedValue(a){var b=new ReflectionObject(this);return b.hasMethod("get"+capitalize(a))?b.getMethod("get"+capitalize(a)).call():b.hasMethod("get")?b.getMethod("get").call(a):b.hasProperty(a)?b.getProperty(a).getValue():void 0}namespace("Sy.Lib.Logger"),Sy.Lib.Logger.Interface=function(){},Sy.Lib.Logger.Interface.prototype=Object.create(Object.prototype,{LOG:{value:"log",writable:!1},DEBUG:{value:"debug",writable:!1},ERROR:{value:"error",writable:!1},INFO:{value:"info",writable:!1},setName:{value:function(){return this}},log:{value:function(){return this}},debug:{value:function(){return this}},error:{value:function(){return this}},info:{value:function(){return this}},setHandler:{value:function(){return this}},isHandlingLevel:{value:function(){}},removeHandler:{value:function(){}},lock:{value:function(){}}}),namespace("Sy.HTTP"),Sy.HTTP.RequestInterface=function(){},Sy.HTTP.RequestInterface.prototype=Object.create(Object.prototype,{setURI:{value:function(){}},getURI:{value:function(){}},setMethod:{value:function(){}},getMethod:{value:function(){}},setData:{value:function(){}},getData:{value:function(){}},setHeader:{value:function(){}},getHeader:{value:function(){}},setListener:{value:function(){}},getListener:{value:function(){}},setType:{value:function(){}},getType:{value:function(){}}}),namespace("Sy.HTTP"),Sy.HTTP.ResponseInterface=function(){},Sy.HTTP.ResponseInterface.prototype=Object.create(Object.prototype,{HTTP_CONTINUE:{value:100,writable:!1},HTTP_SWITCHING_PROTOCOLS:{value:101,writable:!1},HTTP_PROCESSING:{value:102,writable:!1},HTTP_OK:{value:200,writable:!1},HTTP_CREATED:{value:201,writable:!1},HTTP_ACCEPTED:{value:202,writable:!1},HTTP_NON_AUTHORITATIVE_INFORMATION:{value:203,writable:!1},HTTP_NO_CONTENT:{value:204,writable:!1},HTTP_RESET_CONTENT:{value:205,writable:!1},HTTP_PARTIAL_CONTENT:{value:206,writable:!1},HTTP_MULTI_STATUS:{value:207,writable:!1},HTTP_ALREADY_REPORTED:{value:208,writable:!1},HTTP_IM_USED:{value:226,writable:!1},HTTP_MULTIPLE_CHOICES:{value:300,writable:!1},HTTP_MOVED_PERMANENTLY:{value:301,writable:!1},HTTP_FOUND:{value:302,writable:!1},HTTP_SEE_OTHER:{value:303,writable:!1},HTTP_NOT_MODIFIED:{value:304,writable:!1},HTTP_USE_PROXY:{value:305,writable:!1},HTTP_RESERVED:{value:306,writable:!1},HTTP_TEMPORARY_REDIRECT:{value:307,writable:!1},HTTP_PERMANENTLY_REDIRECT:{value:308,writable:!1},HTTP_BAD_REQUEST:{value:400,writable:!1},HTTP_UNAUTHORIZED:{value:401,writable:!1},HTTP_PAYMENT_REQUIRED:{value:402,writable:!1},HTTP_FORBIDDEN:{value:403,writable:!1},HTTP_NOT_FOUND:{value:404,writable:!1},HTTP_METHOD_NOT_ALLOWED:{value:405,writable:!1},HTTP_NOT_ACCEPTABLE:{value:406,writable:!1},HTTP_PROXY_AUTHENTICATION_REQUIRED:{value:407,writable:!1},HTTP_REQUEST_TIMEOUT:{value:408,writable:!1},HTTP_CONFLICT:{value:409,writable:!1},HTTP_GONE:{value:410,writable:!1},HTTP_LENGTH_REQUIRED:{value:411,writable:!1},HTTP_PRECONDITION_FAILED:{value:412,writable:!1},HTTP_REQUEST_ENTITY_TOO_LARGE:{value:413,writable:!1},HTTP_REQUEST_URI_TOO_LONG:{value:414,writable:!1},HTTP_UNSUPPORTED_MEDIA_TYPE:{value:415,writable:!1},HTTP_REQUESTED_RANGE_NOT_SATISFIABLE:{value:416,writable:!1},HTTP_EXPECTATION_FAILED:{value:417,writable:!1},HTTP_I_AM_TEAPOT:{value:418,writable:!1},HTTP_UNPROCESSABLE_ENTITY:{value:422,writable:!1},HTTP_LOCKED:{value:423,writable:!1},HTTP_FAILED_DEPENDENCY:{value:424,writable:!1},HTTP_RESERVED_FOR_WEBDAV_ADVANCED_COLLECTIONS_EXPIRED_PROPOSAL:{value:425,writable:!1},HTTP_UPGRADE_REQUIRED:{value:426,writable:!1},HTTP_PRECONDITION_REQURED:{value:428,writable:!1},HTTP_TOO_MANY_REQUESTS:{value:429,writable:!1},HTTP_REQUEST_HEADER_FIELDS_TOO_LARGE:{value:431,writable:!1},HTTP_INTERNAL_SERVOR_ERROR:{value:500,writable:!1},HTTP_NOT_IMPLEMENTED:{value:501,writable:!1},HTTP_BAD_GATEWAY:{value:502,writable:!1},HTTP_SERVICE_UNAVAILABLE:{value:503,writable:!1},HTTP_GATEWAY_TIMEOUT:{value:504,writable:!1},HTTP_VERSION_NOT_SUPPORTED:{value:505,writable:!1},HTTP_VARIANT_ALSO_NEGOTIATES_EXPERIMENTAL:{value:506,writable:!1},HTTP_INSUFFICIENT_STORAGE:{value:507,writable:!1},HTTP_LOOP_DETECTED:{value:508,writable:!1},HTTP_NOT_EXTENDED:{value:510,writable:!1},HTTP_NETWORK_AUTHENTICATION_REQUIRED:{value:511,writable:!1},setStatusCode:{value:function(){}},getStatusCode:{value:function(){}},setStatusText:{value:function(){}},getStatusText:{value:function(){}},setHeaders:{value:function(){}},getHeader:{value:function(){}},setBody:{value:function(){}},getBody:{value:function(){}}}),namespace("Sy.HTTP"),Sy.HTTP.Request=function(){this.method="GET",this.data=new Sy.Registry,this.headers=new Sy.Registry,this.listener=null,this.type="",this.uri=""},Sy.HTTP.Request.prototype=Object.create(Sy.HTTP.RequestInterface.prototype,{setURI:{value:function(a){return this.uri=a,this}},getURI:{value:function(){return this.uri}},setMethod:{value:function(a){var b=a.toUpperCase();return-1!==["OPTIONS","GET","HEAD","POST","PUT","DELETE","TRACE","CONNECT"].indexOf(b)&&(this.method=b),this}},getMethod:{value:function(){return this.method}},setData:{value:function(a){for(var b in a)a.hasOwnProperty(b)&&this.data.set(b,a[b]);return this}},getData:{value:function(){return this.data.getMapping()}},setHeader:{value:function(a,b){if(a instanceof Object)for(var c in a)a.hasOwnProperty(c)&&this.setHeader(c,a[c]);else"string"==typeof a&&"string"==typeof b&&this.headers.set(a,b);return this}},getHeader:{value:function(a){return void 0!==a?this.headers.has(a)?this.headers.get(a):void 0:this.headers.getMapping()}},setListener:{value:function(a){return this.listener=a,this}},getListener:{value:function(){return this.listener}},setType:{value:function(a){return-1!==["html","json","blob"].indexOf(a)&&(this.type=a),this}},getType:{value:function(){return this.type}}}),namespace("Sy.HTTP"),Sy.HTTP.Response=function(){this.statusCode=0,this.statusText=null,this.headers=new Sy.Registry,this.body=null},Sy.HTTP.Response.prototype=Object.create(Sy.HTTP.ResponseInterface.prototype,{setStatusCode:{value:function(a){return this.statusCode=parseInt(a,10),this}},getStatusCode:{value:function(){return this.statusCode}},setStatusText:{value:function(a){return this.statusText=a,this}},getStatusText:{value:function(){return this.statusText}},setHeaders:{value:function(a){for(var b in a)a.hasOwnProperty(b)&&this.headers.set(b,a[b]);return this}},getHeader:{value:function(a){return void 0===a?this.headers.getMapping():this.headers.has(a)?this.headers.get(a):void 0}},setBody:{value:function(a){return this.body=a,this}},getBody:{value:function(){return this.body}}}),namespace("Sy.HTTP"),Sy.HTTP.JSONRequest=function(){Sy.HTTP.Request.call(this),this.setType("json"),this.setHeader("Accept","application/json")},Sy.HTTP.JSONRequest.prototype=Object.create(Sy.HTTP.Request.prototype),namespace("Sy.HTTP"),Sy.HTTP.JSONResponse=function(){Sy.HTTP.Response.call(this)},Sy.HTTP.JSONResponse.prototype=Object.create(Sy.HTTP.Response.prototype),namespace("Sy.HTTP"),Sy.HTTP.HeaderParser=function(){},Sy.HTTP.HeaderParser.prototype=Object.create(Object.prototype,{parse:{value:function(a){for(var b,c,d,e={},f=a.split("\n"),g=0,h=f.length-1;h>g;g++){switch(d=f[g].indexOf(":"),b=f[g].substring(0,d),c=f[g].substring(d+2),b){case"Date":case"Expires":case"Last-Modified":c=new Date(c)}e[b]=c}return e}}}),namespace("Sy.HTTP"),Sy.HTTP.HTMLRequest=function(){Sy.HTTP.Request.call(this),this.setType("html"),this.setHeader("Accept","text/html,application/xhtml+xml")},Sy.HTTP.HTMLRequest.prototype=Object.create(Sy.HTTP.Request.prototype),namespace("Sy.HTTP"),Sy.HTTP.HTMLResponse=function(){Sy.HTTP.Response.call(this)},Sy.HTTP.HTMLResponse.prototype=Object.create(Sy.HTTP.Response.prototype),namespace("Sy.HTTP"),Sy.HTTP.ImageRequest=function(){Sy.HTTP.Request.call(this),this.setType("blob"),this.setHeader("Accept","image/*")},Sy.HTTP.ImageRequest.prototype=Object.create(Sy.HTTP.Request.prototype),namespace("Sy.HTTP"),Sy.HTTP.ImageResponse=function(){Sy.HTTP.Response.call(this)},Sy.HTTP.ImageResponse.prototype=Object.create(Sy.HTTP.Response.prototype,{getBlob:{value:function(){return this.getBody()}}}),namespace("Sy.HTTP"),Sy.HTTP.Manager=function(){this.requests=null,this.parser=null,this.generator=null,this.logger=null},Sy.HTTP.Manager.prototype=Object.create(Object.prototype,{setParser:{value:function(a){return this.parser=a,this}},setGenerator:{value:function(a){if(!(a instanceof Sy.Lib.Generator.Interface))throw new TypeError("Invalid generator type");return this.generator=a,this}},setRegistry:{value:function(a){if(!(a instanceof Sy.Registry))throw new TypeError("Invalid registry");return this.requests=a,this}},setLogger:{value:function(a){if(!(a instanceof Sy.Lib.Logger.Interface))throw new TypeError("Invalid logger");return this.logger=a,this}},prepare:{value:function(a){if(!(a instanceof Sy.HTTP.RequestInterface))throw new TypeError("Invalid request type");this.logger&&this.logger.info("Preparing a new HTTP request...",a);var b=this.generator.generate(),c={xhr:null,obj:a,uuid:b},d=a.getHeader(),e=a.getData(),f=new FormData;switch(c.xhr=new XMLHttpRequest,c.xhr.open(a.getMethod(),a.getURI()),c.xhr.UUID=b,c.xhr.addEventListener("readystatechange",this.listener.bind(this),!1),a.getType()){case"html":c.xhr.responseType="document";break;case"json":c.xhr.responseType="json"}for(var g in d)d.hasOwnProperty(g)&&c.xhr.setRequestHeader(g,d[g]);for(var h in e)e.hasOwnProperty(h)&&f.append(h,e[h]);return c.data=f,this.requests.set(b,c),this.logger&&this.logger.info("HTTP request prepared",c),b}},getXHR:{value:function(a){var b=this.requests.get(a);return b.xhr}},launch:{value:function(a){if("string"==typeof a){var b=this.requests.get(a);return this.logger&&this.logger.info("Launching a HTTP request...",b),b.xhr.send(b.data),b.uuid}return this.launch(this.prepare(a))}},listener:{value:function(a){if(a.target.readyState===a.target.DONE&&this.requests.has(a.target.UUID)){var b,c=this.requests.get(a.target.UUID),d=c.obj.getListener(),e=this.parser.parse(a.target.getAllResponseHeaders());b=void 0!==e["Content-Type"]&&-1!==e["Content-Type"].indexOf("application/json")&&"json"===c.obj.getType()?new Sy.HTTP.JSONResponse:void 0!==e["Content-Type"]&&-1!==e["Content-Type"].indexOf("text/html")&&"html"===c.obj.getType()?new Sy.HTTP.HTMLResponse:void 0!==e["Content-Type"]&&-1!==e["Content-Type"].indexOf("image/")&&"blob"===c.obj.getType()?new Sy.HTTP.ImageResponse:new Sy.HTTP.Response,b.setHeaders(e),b.setStatusCode(a.target.status),b.setStatusText(a.target.statusText),b.setBody(a.target.response),this.requests.remove(a.target.UUID),d instanceof Function&&(this.logger&&this.logger.info("Notifying the request is finished...",b),d(b))}}},abort:{value:function(a){var b=this.requests.get(a);return b.xhr.abort(),this.requests.remove(a),this.logger&&this.logger.info("HTTP request aborted",a),this}},getStack:{value:function(){return this.requests.get()}}}),namespace("Sy.HTTP"),Sy.HTTP.REST=function(){this.manager=null},Sy.HTTP.REST.prototype=Object.create(Object.prototype,{setManager:{value:function(a){if(!(a instanceof Sy.HTTP.Manager))throw new TypeError("Invalid manager");return this.manager=a,this}},request:{value:function(a){var b=new Sy.HTTP.JSONRequest;a.data=a.data||{},a.headers=a.headers||{},b.setMethod(a.method),b.setURI(a.uri),b.setHeader(a.headers),b.setData(a.data),b.setListener(a.listener),this.manager.launch(b)}},get:{value:function(a){return a.method="get",this.request(a),this}},post:{value:function(a){return a.method="post",this.request(a),this}},put:{value:function(a){return a.method="put",a.data=a.data||{_method:"put"},this.request(a),this}},remove:{value:function(a){return a.method="delete",a.data=a.data||{_method:"delete"},this.request(a),this}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.Interface=function(){},Sy.Lib.Generator.Interface.prototype=Object.create(Object.prototype,{generate:{value:function(){}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.UUID=function(){},Sy.Lib.Generator.UUID.prototype=Object.create(Sy.Lib.Generator.Interface.prototype,{s4:{value:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},generate:{value:function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()}}}),namespace("Sy"),Sy.FactoryInterface=function(){},Sy.FactoryInterface.prototype=Object.create(Object.prototype,{make:{value:function(){}}}),namespace("Sy"),Sy.RegistryInterface=function(){},Sy.RegistryInterface.prototype=Object.create(Object.prototype,{set:{value:function(){}},has:{value:function(){}},get:{value:function(){}},getMapping:{value:function(){}},remove:{value:function(){}},length:{value:function(){}}}),namespace("Sy"),Sy.Registry=function(){this.data={},this.registryLength=0},Sy.Registry.prototype=Object.create(Sy.RegistryInterface.prototype,{set:{value:function(a,b){return"string"==typeof a&&(this.data[a]=b,this.registryLength++),this}},has:{value:function(a){return this.data.hasOwnProperty(a)?!0:!1}},get:{value:function(a){if(this.has(a))return this.data[a];if(void 0===a){var b=[];for(var c in this.data)this.data.hasOwnProperty(c)&&b.push(this.data[c]);return b}throw new ReferenceError('"'+a+'" is not defined')}},getMapping:{value:function(){var a={};for(var b in this.data)this.data.hasOwnProperty(b)&&(a[b]=this.data[b]);return a}},remove:{value:function(a){if(void 0===a)for(var b in this.data)this.data.hasOwnProperty(b)&&this.remove(b);else if(a instanceof Array)for(var c=0,d=a.length;d>c;c++)this.remove(a[c]);else"string"==typeof a&&this.has(a)&&(delete this.data[a],this.registryLength--);return this}},length:{value:function(){return this.registryLength}}}),namespace("Sy"),Sy.RegistryFactory=function(){},Sy.RegistryFactory.prototype=Object.create(Sy.FactoryInterface.prototype,{make:{value:function(){return new Sy.Registry}}});