/*! sy#0.7.0 - 2014-09-26 */
function namespace(a){var b=null,c=this;if("string"==typeof a)b=a.split(".");else{if(!(a instanceof Array&&a.length>0))return c;b=a}return c[b[0]]=c[b[0]]||{},a=b.shift(),namespace.call(c[a],b)}function objectSetter(a,b){var c="",d="",e=this,f=a.lastIndexOf(".");f>=0?(d=a.substr(f+1),c=a.substr(0,f),e=namespace.call(e,c)):d=a,e[d]=b}function objectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return c[a]}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?c[a[0]]:void 0;b=a}return a=b.shift(),objectGetter.call(c[a],b)}function capitalize(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function reflectedObjectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return getReflectedValue.call(c,a)}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?getReflectedValue.call(c,a[0]):void 0;b=a}return a=b.shift(),reflectedObjectGetter.call(getReflectedValue.call(c,a),b)}function getReflectedValue(a){var b=new ReflectionObject(this);return b.hasMethod("get"+capitalize(a))?b.getMethod("get"+capitalize(a)).call():b.hasMethod("get")?b.getMethod("get").call(a):b.hasProperty(a)?b.getProperty(a).getValue():void 0}namespace("Sy"),Sy.FactoryInterface=function(){},Sy.FactoryInterface.prototype=Object.create(Object.prototype,{make:{value:function(){}}}),namespace("Sy"),Sy.RegistryInterface=function(){},Sy.RegistryInterface.prototype=Object.create(Object.prototype,{set:{value:function(){}},has:{value:function(){}},get:{value:function(){}},getMapping:{value:function(){}},remove:{value:function(){}},length:{value:function(){}}}),namespace("Sy"),Sy.Registry=function(){this.data={},this.registryLength=0},Sy.Registry.prototype=Object.create(Sy.RegistryInterface.prototype,{set:{value:function(a,b){return"string"==typeof a&&(this.data[a]=b,this.registryLength++),this}},has:{value:function(a){return this.data.hasOwnProperty(a)?!0:!1}},get:{value:function(a){if(this.has(a))return this.data[a];if(void 0===a){var b=[];for(var c in this.data)this.data.hasOwnProperty(c)&&b.push(this.data[c]);return b}throw new ReferenceError('"'+a+'" is not defined')}},getMapping:{value:function(){var a={};for(var b in this.data)this.data.hasOwnProperty(b)&&(a[b]=this.data[b]);return a}},remove:{value:function(a){if(void 0===a)for(var b in this.data)this.data.hasOwnProperty(b)&&this.remove(b);else if(a instanceof Array)for(var c=0,d=a.length;d>c;c++)this.remove(a[c]);else"string"==typeof a&&this.has(a)&&(delete this.data[a],this.registryLength--);return this}},length:{value:function(){return this.registryLength}}}),namespace("Sy"),Sy.RegistryFactory=function(){},Sy.RegistryFactory.prototype=Object.create(Sy.FactoryInterface.prototype,{make:{value:function(){return new Sy.Registry}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.Interface=function(){},Sy.Lib.Generator.Interface.prototype=Object.create(Object.prototype,{generate:{value:function(){}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.UUID=function(){},Sy.Lib.Generator.UUID.prototype=Object.create(Sy.Lib.Generator.Interface.prototype,{s4:{value:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},generate:{value:function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()}}}),namespace("Sy.Lib"),Sy.Lib.Mediator=function(){this.channels={},this.generator=null,this.logger=null},Sy.Lib.Mediator.prototype=Object.create(Object.prototype,{subscribe:{value:function(a){var a=a||{},b=null;return void 0===a.priority&&(a.priority=1),void 0===this.channels[a.channel]&&(b=new Sy.Lib.MediatorChannel(a.channel),b.setGenerator(this.generator),this.logger&&b.setLogger(this.logger),this.channels[a.channel]=b),this.channels[a.channel].add(a.fn,a.context,a.priority,a.async,a.bubbles)}},remove:{value:function(a,b){return void 0!==this.channels[a]&&this.channels[a].remove(b),this}},publish:{value:function(){if(0===arguments.length)return this;var a=Array.prototype.slice.call(arguments,0,1)[0],b=Array.prototype.slice.call(arguments,1);return void 0!==this.channels[a]&&this.channels[a].publish(b),this}},pause:{value:function(a,b){return void 0!==this.channels[a]&&(this.channels[a].stopped=!0,b&&this.channels[a].pause(b)),this}},unpause:{value:function(a,b){return void 0!==this.channels[a]&&(this.channels[a].stopped=!1,b&&this.channels[a].unpause(b)),this}},paused:{value:function(a){return void 0!==this.channels[a]?this.channels[a].stopped:void 0}},setGenerator:{value:function(a){if(!(a instanceof Sy.Lib.Generator.Interface))throw new TypeError("Invalid generator");return this.generator=a,this}},setLogger:{value:function(a){if(!(a instanceof Sy.Lib.Logger.Interface))throw new TypeError("Invalid logger");return this.logger=a,this}}}),Sy.Lib.MediatorChannel=function(a){this.name=a||"",this.stopped=!1,this.subscribers={},this.generator=null,this.logger=null},Sy.Lib.MediatorChannel.prototype=Object.create(Object.prototype,{add:{value:function(a,b,c,d,e){var f=this.generator.generate();return this.subscribers[f]={fn:a,context:b||window,priority:c||1,async:!!d,bubbles:!!e,stopped:!1},f}},remove:{value:function(a){return delete this.subscribers[a],this}},publish:{value:function(a){var a=a||[];if(this.stopped===!1){var b=[];for(var c in this.subscribers)this.subscribers.hasOwnProperty(c)&&this.subscribers[c].stopped===!1&&b.push(this.subscribers[c]);b.sort(function(a,b){return a.priority-b.priority});for(var d=0,e=b.length;e>d;d++)try{var f=b[d];f.async===!0?setTimeout(this.subscriberCall,0,this,f.fn,f.context,a):this.subscriberCall(this,f.fn,f.context,a)}catch(g){if(this.logger&&this.logger.error(g.message,g),f.bubbles===!0)throw g}}return this}},setGenerator:{value:function(a){if(!(a instanceof Sy.Lib.Generator.Interface))throw new TypeError("Invalid generator");return this.generator=a,this}},setLogger:{value:function(a){if(!(a instanceof Sy.Lib.Logger.Interface))throw new TypeError("Invalid logger");return this.logger=a,this}},subscriberCall:{value:function(a,b,c,d){b.apply(c,d)}},pause:{value:function(a){return this.subscribers[a]&&(this.subscribers[a].stopped=!0),this}},unpause:{value:function(a){return this.subscribers[a]&&(this.subscribers[a].stopped=!1),this}}}),namespace("Sy.Lib.Logger"),Sy.Lib.Logger.Interface=function(){},Sy.Lib.Logger.Interface.prototype=Object.create(Object.prototype,{LOG:{value:"log",writable:!1},DEBUG:{value:"debug",writable:!1},ERROR:{value:"error",writable:!1},INFO:{value:"info",writable:!1},setName:{value:function(){return this}},log:{value:function(){return this}},debug:{value:function(){return this}},error:{value:function(){return this}},info:{value:function(){return this}},setHandler:{value:function(){return this}},isHandlingLevel:{value:function(){}},removeHandler:{value:function(){}},lock:{value:function(){}}}),namespace("Sy.Lib.Logger.Handler"),Sy.Lib.Logger.Handler.Interface=function(){},Sy.Lib.Logger.Handler.Interface.prototype=Object.create(Object.prototype,{handle:{value:function(){}},isHandling:{value:function(){}}}),namespace("Sy.Lib.Logger.Handler"),Sy.Lib.Logger.Handler.Console=function(a){this.level=null,void 0!==a&&this.setLevel(a)},Sy.Lib.Logger.Handler.Console.prototype=Object.create(Sy.Lib.Logger.Handler.Interface.prototype,{setLevel:{value:function(a){if(!this.checkLevel(a))throw new TypeError("Unknown logger level");return this.level=a,this}},checkLevel:{value:function(a){return a.toUpperCase()in Sy.Lib.Logger.Interface.prototype?!0:!1}},isHandling:{value:function(a){return a===this.level?!0:!1}},handle:{value:function(a,b,c,d){if(this.isHandling(b)&&"console"in window){var e="["+moment().format("YYYY-M-D hh:mm:ss")+"]",f=d||[];c=c||"",e+=" "+a+"."+b.toUpperCase(),e+=" "+c.toString(),console[b](e,f)}return this}}}),namespace("Sy.Lib.Logger"),Sy.Lib.Logger.CoreLogger=function(a){this.name="",this.handlers={},this.setName(a)},Sy.Lib.Logger.CoreLogger.prototype=Object.create(Sy.Lib.Logger.Interface.prototype,{setName:{value:function(a){return this.name=a||"null",this}},setHandler:{value:function(a,b){return a instanceof Sy.Lib.Logger.Handler.Interface&&b.toUpperCase()in this&&(this.handlers[b]=a),this}},isHandlingLevel:{value:function(a){return!!this.handlers[a]}},removeHandler:{value:function(a){return this.isHandlingLevel(a)&&delete this.handlers[a],this}},handle:{value:function(a,b,c){return this.handlers[a]&&this.handlers[a].handle(this.name,a,b,c),this}},log:{value:function(a,b){return this.handle(this.LOG,a,b),this}},debug:{value:function(a,b){return this.handle(this.DEBUG,a,b),this}},error:{value:function(a,b){return this.handle(this.ERROR,a,b),this}},info:{value:function(a,b){return this.handle(this.INFO,a,b),this}},lock:{value:function(){return Object.seal(this.handlers),this}}}),DOM=function(a){return this===window?new DOM(a):void(this.node=a)},DOM.prototype=Object.create(Object.prototype,{isChildOf:{value:function(a,b){return b=b||this.node,a instanceof HTMLElement?a===b?!0:this.isChildOf(a,b.parentNode):"string"==typeof a?this.matches(a)?!0:this.matches(a,b.parentNode):!1}},matches:{value:function(a,b){return b=b||this.node,b.matches&&b.matches(a)?!0:b.webkitMatchesSelector&&b.webkitMatchesSelector(a)?!0:b.mozMatchesSelector&&b.mozMatchesSelector(a)?!0:b.msMatchesSelector&&b.msMatchesSelector(a)?!0:!1}}}),namespace("Sy.View"),Sy.View.LayoutFactoryInterface=function(){},Sy.View.LayoutFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setParser:{value:function(){}},setTemplateEngine:{value:function(){}},setRegistryFactory:{value:function(){}},setListFactory:{value:function(){}},setLayoutWrapper:{value:function(){}}}),namespace("Sy.View"),Sy.View.ListFactoryInterface=function(){},Sy.View.ListFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setTemplateEngine:{value:function(){}},setRegistry:{value:function(){}},setListWrapper:{value:function(){}}}),namespace("Sy.View"),Sy.View.TemplateEngineInterface=function(){},Sy.View.TemplateEngineInterface.prototype=Object.create(Object.prototype,{PATTERN:{value:new RegExp(/{{\s?([\w.]+)\s?}}/gim),writable:!1,configurable:!1},render:{value:function(){}}}),namespace("Sy.View"),Sy.View.ViewScreenFactoryInterface=function(){},Sy.View.ViewScreenFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setParser:{value:function(){}},setTemplateEngine:{value:function(){}},setRegistryFactory:{value:function(){}},setLayoutFactory:{value:function(){}},setViewScreenWrapper:{value:function(){}}}),namespace("Sy.View.Event"),Sy.View.Event.ViewPortEvent=function(a){if(!(a instanceof Sy.View.ViewScreen))throw new TypeError("Invalid viewscreen");this.viewscreen=a},Sy.View.Event.ViewPortEvent.prototype=Object.create(Object.prototype,{PRE_DISPLAY:{value:"view::on::pre::display",writable:!1},POST_DISPLAY:{value:"view::on::post::display",writable:!1},getViewScreen:{value:function(){return this.viewscreen}}}),namespace("Sy.View"),Sy.View.NodeWrapper=function(){this.engine=null,this.node=null},Sy.View.NodeWrapper.prototype=Object.create(Object.prototype,{setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setNode:{value:function(a){if(!(a instanceof HTMLElement))throw new TypeError("Invalid dom node");return this.node=a,this}},getNode:{value:function(){return this.node}},render:{value:function(a){return this.engine.render(this.node,a),this}},findOne:{value:function(a){return this.node.querySelector(a)}},find:{value:function(a){return this.node.querySelectorAll(a)}}}),namespace("Sy.View"),Sy.View.Layout=function(){Sy.View.NodeWrapper.call(this),this.name=null,this.lists=null,this.parser=null,this.listFactory=null,this.screen=null},Sy.View.Layout.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b,c;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syLayout,b=this.parser.getLists(a);for(var d=0,e=b.length;e>d;d++)c=this.listFactory.make(this.screen,this.name,b[d]),this.lists.set(c.getName(),c);return this}},setViewScreenName:{value:function(a){return this.screen=a,this}},getName:{value:function(){return this.name}},setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setListsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.lists=a,this}},setListFactory:{value:function(a){if(!(a instanceof Sy.View.ListFactoryInterface))throw new TypeError("Invalid list factory");return this.listFactory=a,this}},getLists:{value:function(){return this.lists.get()}},getList:{value:function(a){return this.lists.get(a)}}}),namespace("Sy.View"),Sy.View.LayoutFactory=function(){this.parser=null,this.engine=null,this.registryFactory=null,this.listFactory=null,this.layouts=null},Sy.View.LayoutFactory.prototype=Object.create(Sy.View.LayoutFactoryInterface.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistryFactory:{value:function(a){if(!(a instanceof Sy.RegistryFactory))throw new TypeError("Invalid registry factory");return this.registryFactory=a,this.layouts=a.make(),this}},setListFactory:{value:function(a){if(!(a instanceof Sy.View.ListFactoryInterface))throw new TypeError("Invalid list factory");return this.listFactory=a,this}},setLayoutWrapper:{value:function(a,b,c){var d=a+"::"+b;if(this.layouts.has(d))throw new ReferenceError('A layout wrapper is already defined with the name "'+d+'"');if(!(c instanceof Sy.View.Layout))throw new TypeError("Invalid layout wrapper");return this.layouts.set(d,c),this}},make:{value:function(a,b){var c,d=a+"::"+b.dataset.syLayout;return c=this.layouts.has(d)?this.layouts.get(d):new Sy.View.Layout,c.setViewScreenName(a).setParser(this.parser).setListFactory(this.listFactory).setListsRegistry(this.registryFactory.make()).setTemplateEngine(this.engine).setNode(b)}}}),namespace("Sy.View"),Sy.View.List=function(){Sy.View.NodeWrapper.call(this),this.name=null,this.elements=[],this.types=[],this.screen=null,this.layout=null},Sy.View.List.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syList;for(var c=0,d=a.childElementCount;d>c;c++){if(b=a.firstElementChild,this.elements.push(b),a.removeChild(b),this.elements.length>1&&void 0===b.dataset.type)throw new SyntaxError("Multiple list elements require a type to be set");if(void 0!==b.dataset.type){if(-1!==this.types.indexOf(b.dataset.type))throw new SyntaxError("Multiple list elements defined with the same type");this.types.push(b.dataset.type)}}return this}},setViewScreenName:{value:function(a){return this.screen=a,this}},setLayoutName:{value:function(a){return this.layout=a,this}},getName:{value:function(){return this.name}},renderElement:{value:function(a,b){var c,d=b?this.types.indexOf(b):0;if(-1===d)throw new ReferenceError('The type "'+b+'" does not exist for the list "'+this.getName()+'"');return c=this.elements[d].cloneNode(!0),this.engine.render(c,a)}},append:{value:function(a,b){return this.getNode().appendChild(this.renderElement(a,b)),this}},prepend:{value:function(a,b){return this.getNode().insertBefore(this.renderElement(a,b),this.getNode().firstElementChild),this}},render:{value:function(a){for(var b,c,d=this.getNode();d.firstElementChild;)d.removeChild(d.firstElementChild);for(var e=0,f=a.length;f>e;e++)b=a[e],c=b._type,this.append(b,c);return this}}}),namespace("Sy.View"),Sy.View.ListFactory=function(){this.engine=null,this.lists=null},Sy.View.ListFactory.prototype=Object.create(Sy.View.ListFactoryInterface.prototype,{setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.lists=a,this}},setListWrapper:{value:function(a,b,c,d){var e=a+"::"+b+"::"+c;if(this.lists.has(e))throw new ReferenceError('A list wrapper is already defined with the name "'+e+'"');if(!(d instanceof Sy.View.List))throw new TypeError("Invalid list wrapper");return this.lists.set(e,d),this}},make:{value:function(a,b,c){var d,e=a+"::"+b+"::"+c.dataset.syList;return d=this.lists.has(e)?this.lists.get(e):new Sy.View.List,d.setViewScreenName(a).setLayoutName(b).setTemplateEngine(this.engine).setNode(c)}}}),namespace("Sy.View"),Sy.View.Manager=function(){this.views=null,this.factory=null},Sy.View.Manager.prototype=Object.create(Object.prototype,{setViewsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.views=a,this}},setViewScreenFactory:{value:function(a){if(!(a instanceof Sy.View.ViewScreenFactoryInterface))throw new TypeError("Invalid factory");return this.factory=a,this}},setViewScreen:{value:function(a){if(!(a instanceof HTMLElement))throw new TypeError("Html node expected");var b=a.dataset.syView;if(!b&&""===b.trim())throw new SyntaxError('Attribute "data-sy-view" is expected');if(this.views.has(b.trim()))throw new ReferenceError('A view with the name "'+b.trim()+'" already exist');return this.views.set(b.trim(),this.factory.make(a)),this}},getViewScreen:{value:function(a){if(!this.views.has(a))throw new ReferenceError('The view screen "'+a+'" is not registered');return this.views.get(a)}},getViewScreens:{value:function(){return this.views.get()}}}),namespace("Sy.View"),Sy.View.ManagerConfigurator=function(){this.parser=null},Sy.View.ManagerConfigurator.prototype=Object.create(Object.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");this.parser=a}},configure:{value:function(a){if(!(a instanceof Sy.View.Manager))throw new TypeError("Invalid manager");for(var b=this.parser.getViewScreens(),c=0,d=b.length;d>c;c++)a.setViewScreen(b[c]),DOM(b[c]).isChildOf(".viewport")||b[c].parentNode.removeChild(b[c])}}}),namespace("Sy.View"),Sy.View.Parser=function(){},Sy.View.Parser.prototype=Object.create(Object.prototype,{get:{value:function(a,b){return b=b||document.body,b.querySelectorAll(a)}},getViewScreens:{value:function(a){return this.get("[data-sy-view]",a)}},getLayouts:{value:function(a){return this.get("[data-sy-layout]",a)}},getLists:{value:function(a){return this.get("[data-sy-list]",a)}}}),namespace("Sy.View"),Sy.View.TemplateEngine=function(){Sy.View.TemplateEngineInterface.call(this),this.registry=null,this.generator=null},Sy.View.TemplateEngine.prototype=Object.create(Sy.View.TemplateEngineInterface.prototype,{setRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.registry=a,this}},setGenerator:{value:function(a){if(!(a instanceof Sy.Lib.Generator.Interface))throw new TypeError("Invalid generator");return this.generator=a,this}},render:{value:function(a,b){if(a.dataset.syUuid||this.register(a),a.dataset.syUuid&&this.registry.has(a.dataset.syUuid)&&(this.renderAllAttributes(a,b),this.renderContent(a,b)),a.childElementCount>0)for(var c=0,d=a.childElementCount;d>c;c++)this.render(a.children[c],b);return a}},register:{value:function(a){for(var b=this.generator.generate(),c={attributes:{},textContent:null,uuid:b},d=0,e=a.attributes.length;e>d;d++)c.attributes[a.attributes[d].name]=a.getAttribute(a.attributes[d].name);return c.textContent=a.textContent,a.dataset.syUuid=b,this.registry.set(b,c),this}},renderAllAttributes:{value:function(a,b){for(var c=0,d=a.attributes.length;d>c;c++)this.renderAttribute(a,a.attributes[c].name,b);return a}},renderAttribute:{value:function(a,b,c){var d,e=a.dataset.syUuid,f=this.registry.get(e).attributes[b];return f?(d=this.replace(f,c),a.setAttribute(b,d),a):a}},replace:{value:function(a,b){for(;a.match(this.PATTERN);){var c=this.PATTERN.exec(a);null!==c&&c.length>=1&&(a=a.replace(c[0],reflectedObjectGetter.call(b,c[1])||""))}return a}},renderContent:{value:function(a,b){if(a.childElementCount>0)return a;var c,d=a.dataset.syUuid,e=this.registry.get(d).textContent,f=this.PATTERN.exec(e);return f&&(c=objectGetter.call(b,f[1])),c instanceof HTMLElement?(a.removeChild(a.firstElementChild),a.appendChild(c)):a.textContent=this.replace(e,b),a}}}),namespace("Sy.View"),Sy.View.ViewPort=function(){this.node=null,this.manager=null,this.mediator=null,this.current=null},Sy.View.ViewPort.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setMediator:{value:function(a){if(!(a instanceof Sy.Lib.Mediator))throw new TypeError("Invalid mediator");return this.mediator=a,this}},setNode:{value:function(a){if(!(a instanceof HTMLElement&&a.classList.contains("viewport")))throw new TypeError("Invalid node");return this.node=a,this}},setViewManager:{value:function(a){if(!(a instanceof Sy.View.Manager))throw new TypeError("Invalid manager");return this.manager=a,this}},getViewManager:{value:function(){return this.manager}},getCurrentViewScreen:{value:function(){return null===this.current&&1===this.node.childElementCount&&(this.current=this.manager.getViewScreen(this.node.firstElementChild.dataset.syView)),this.current}},display:{value:function(a){var b=this.manager.getViewScreen(a),c=b.getNode(),d=new Sy.View.Event.ViewPortEvent(b);switch(this.mediator&&this.mediator.publish(d.PRE_DISPLAY,d),this.node.childElementCount){case 0:this.node.appendChild(c);break;case 1:this.node.replaceChild(c,this.node.children[0]);break;default:throw new Error("Viewport in weird state (more than 1 child)")}return this.current=b,this.mediator&&this.mediator.publish(d.POST_DISPLAY,d),this}}}),namespace("Sy.View"),Sy.View.ViewScreen=function(){Sy.View.NodeWrapper.call(this),this.name="",this.parser=null,this.layouts=null,this.layoutFactory=null},Sy.View.ViewScreen.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b,c;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syView,b=this.parser.getLayouts(a);for(var d=0,e=b.length;e>d;d++)c=this.layoutFactory.make(this.name,b[d]),this.layouts.set(c.getName(),c);return this}},getName:{value:function(){return this.name}},setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setLayoutsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.layouts=a,this}},setLayoutFactory:{value:function(a){if(!(a instanceof Sy.View.LayoutFactoryInterface))throw new TypeError("Invalid layout factory");return this.layoutFactory=a,this}},getLayouts:{value:function(){return this.layouts.get()}},getLayout:{value:function(a){return this.layouts.get(a)}}}),namespace("Sy.View"),Sy.View.ViewScreenFactory=function(){this.parser=null,this.engine=null,this.registryFactory=null,this.layoutFactory=null,this.viewscreens=null},Sy.View.ViewScreenFactory.prototype=Object.create(Sy.View.ViewScreenFactoryInterface.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistryFactory:{value:function(a){if(!(a instanceof Sy.RegistryFactory))throw new TypeError("Invalid registry factory");return this.registryFactory=a,this.viewscreens=a.make(),this}},setLayoutFactory:{value:function(a){if(!(a instanceof Sy.View.LayoutFactoryInterface))throw new TypeError("Invalid layout factory");return this.layoutFactory=a,this}},setViewScreenWrapper:{value:function(a,b){if(this.viewscreens.has(a))throw new ReferenceError('A viewscreen wrapper is already defined with the name "'+a+'"');if(!(b instanceof Sy.View.ViewScreen))throw new TypeError("Invalid viewscreen wrapper");return this.viewscreens.set(a,b),this}},make:{value:function(a){var b,c=a.dataset.syView;return b=this.viewscreens.has(c)?this.viewscreens.get(c):new Sy.View.ViewScreen,b.setParser(this.parser).setLayoutFactory(this.layoutFactory).setLayoutsRegistry(this.registryFactory.make()).setTemplateEngine(this.engine).setNode(a)}}});