/*! sy#1.2.0 - 2015-01-13 */
function namespace(a){var b=null,c=this;if("string"==typeof a)b=a.split(".");else{if(!(a instanceof Array&&a.length>0))return c;b=a}return c[b[0]]=c[b[0]]||{},a=b.shift(),namespace.call(c[a],b)}function objectSetter(a,b){var c="",d="",e=this,f=a.lastIndexOf(".");f>=0?(d=a.substr(f+1),c=a.substr(0,f),e=namespace.call(e,c)):d=a,e[d]=b}function objectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return c[a]}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?c[a[0]]:void 0;b=a}return a=b.shift(),objectGetter.call(c[a],b)}function capitalize(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function reflectedObjectGetter(a){var b=null,c=this;if("string"==typeof a){if(b=a.split("."),1===b.length)return getReflectedValue.call(c,a)}else{if(!(a instanceof Array&&a.length>1))return a instanceof Array&&1===a.length?getReflectedValue.call(c,a[0]):void 0;b=a}return a=b.shift(),reflectedObjectGetter.call(getReflectedValue.call(c,a),b)}function getReflectedValue(a){var b=new ReflectionObject(this);return b.hasMethod("get"+capitalize(a))?b.getMethod("get"+capitalize(a)).call():b.hasMethod("get")?b.getMethod("get").call(a):b.hasProperty(a)?b.getProperty(a).getValue():void 0}namespace("Sy"),Sy.FactoryInterface=function(){},Sy.FactoryInterface.prototype=Object.create(Object.prototype,{make:{value:function(){}}}),namespace("Sy"),Sy.RegistryInterface=function(){},Sy.RegistryInterface.prototype=Object.create(Object.prototype,{set:{value:function(){}},has:{value:function(){}},get:{value:function(){}},getMapping:{value:function(){}},remove:{value:function(){}},length:{value:function(){}}}),namespace("Sy"),Sy.Registry=function(){this.data={},this.registryLength=0},Sy.Registry.prototype=Object.create(Sy.RegistryInterface.prototype,{set:{value:function(a,b){return"string"==typeof a&&(this.data[a]=b,this.registryLength++),this}},has:{value:function(a){return this.data.hasOwnProperty(a)?!0:!1}},get:{value:function(a){if(this.has(a))return this.data[a];if(void 0===a){var b=[];for(var c in this.data)this.data.hasOwnProperty(c)&&b.push(this.data[c]);return b}throw new ReferenceError('"'+a+'" is not defined')}},getMapping:{value:function(){var a={};for(var b in this.data)this.data.hasOwnProperty(b)&&(a[b]=this.data[b]);return a}},remove:{value:function(a){if(void 0===a)for(var b in this.data)this.data.hasOwnProperty(b)&&this.remove(b);else if(a instanceof Array)for(var c=0,d=a.length;d>c;c++)this.remove(a[c]);else"string"==typeof a&&this.has(a)&&(delete this.data[a],this.registryLength--);return this}},length:{value:function(){return this.registryLength}}}),namespace("Sy"),Sy.RegistryFactory=function(){},Sy.RegistryFactory.prototype=Object.create(Sy.FactoryInterface.prototype,{make:{value:function(){return new Sy.Registry}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.Interface=function(){},Sy.Lib.Generator.Interface.prototype=Object.create(Object.prototype,{generate:{value:function(){}}}),namespace("Sy.Lib.Generator"),Sy.Lib.Generator.UUID=function(){},Sy.Lib.Generator.UUID.prototype=Object.create(Sy.Lib.Generator.Interface.prototype,{s4:{value:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},generate:{value:function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.Event=function(){this.propagationStopped=!1,this.dispatcher=null,this.name=null},Sy.EventDispatcher.Event.prototype=Object.create(Object.prototype,{isPropagationStopped:{value:function(){return this.propagationStopped}},stopPropagation:{value:function(){this.propagationStopped=!0}},setDispatcher:{value:function(a){if(!(a instanceof Sy.EventDispatcher.EventDispatcherInterface))throw new TypeError("Invalid event dispatcher");this.dispatcher=a}},getDispatcher:{value:function(){return this.dispatcher}},setName:{value:function(a){this.name=a}},getName:{value:function(){return this.name}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.EventDispatcherInterface=function(){},Sy.EventDispatcher.EventDispatcherInterface.prototype=Object.create(Object.prototype,{dispatch:{value:function(){}},addListener:{value:function(){}},addSubscriber:{value:function(){}},removeListener:{value:function(){}},removeSubsriber:{value:function(){}},getListeners:{value:function(){}},hasListeners:{value:function(){}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.EventDispatcher=function(){this.listeners={},this.sorted={}},Sy.EventDispatcher.EventDispatcher.prototype=Object.create(Sy.EventDispatcher.EventDispatcherInterface.prototype,{dispatch:{value:function(a,b){if(b||(b=new Sy.EventDispatcher.Event),!(b instanceof Sy.EventDispatcher.Event))throw new TypeError("Invalid event object");return b.setDispatcher(this),b.setName(a),this.hasListeners(a)?(this.doDispatch(this.getListeners(a),a,b),b):b}},doDispatch:{value:function(a,b,c){for(var d=0,e=a.length;e>d&&(a[d](c,b,this),!c.isPropagationStopped());d++);}},addListener:{value:function(a,b,c){if(!(b instanceof Function||b instanceof Array||b[0]instanceof Object||b[1]instanceof Function))throw new TypeError("A listener must be a function");return this.listeners[a]instanceof Array||(this.listeners[a]=[]),this.sorted[a]&&(this.sorted[a]=void 0),this.listeners[a].push({listener:b,priority:c||0}),this}},addSubscriber:{value:function(a){if(!(a instanceof Sy.EventDispatcher.EventSubscriberInterface))throw new TypeError("Invalid event subscriber");var b=a.getSubscribedEvents();for(var c in b)if(b.hasOwnProperty(c))if(b[c]instanceof Array)for(var d=0,e=b[c].length;e>d;d++)this.addListener(c,[a,a[b[c][d].method]],b[c][d].priority);else b[c]instanceof Object?this.addListener(c,[a,a[b[c].method]],b[c].priority):this.addListener(c,[a,a[b[c]]]);return this}},removeListener:{value:function(a,b){if(!(b instanceof Function||b instanceof Array||b[0]instanceof Object||b[1]instanceof Function))throw new TypeError("Invalid event listener");if(!this.listeners.hasOwnProperty(a))return this;this.sorted[a]&&(this.sorted[a]=void 0);for(var c=0,d=this.listeners[a].length;d>c;c++)if(b instanceof Array&&this.listeners[a][c].listener[0]===b[0]&&this.listeners[a][c].listener[1]===b[1]||this.listeners[a][c].listener===b){this.listeners[a].splice(c,1);break}return this}},removeSubscriber:{value:function(a){if(!(a instanceof Sy.EventDispatcher.EventSubscriberInterface))throw new TypeError("Invalid event subscriber");var b=a.getSubscribedEvents();for(var c in b)if(b.hasOwnProperty(c))if(b[c]instanceof Array)for(var d=0,e=b[c].length;e>d;d++)this.removeListener(c,[a,a[b[c][d].method]]);else b[c]instanceof Object?this.removeListener(c,[a,a[b[c].method]]):this.removeListener(c,[a,a[b[c]]]);return this}},getListeners:{value:function(a){return this.hasListeners(a)?(this.sorted[a]||this.sortListeners(a),this.sorted[a]):[]}},hasListeners:{value:function(a){return!!this.listeners[a]&&!!this.listeners[a].length}},sortListeners:{value:function(a){this.listeners[a].sort(function(a,b){return a.priority<b.priority}),this.sorted[a]=this.listeners[a].map(function(a){return a.listener instanceof Array?a.listener[1].bind(a.listener[0]):a.listener})}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.ImmutableEventDispatcher=function(a){if(!(a instanceof Sy.EventDispatcher.EventDispatcherInterface))throw new TypeError("Invalid event dispatcher");this.dispatcher=a},Sy.EventDispatcher.ImmutableEventDispatcher.prototype=Object.create(Sy.EventDispatcher.EventDispatcherInterface.prototype,{dispatch:{value:function(a,b){return this.dispatcher.dispatch(a,b)}},addListener:{value:function(){throw new Error("Unmodifiable event dispatchers must not be modified")}},addSubscriber:{value:function(){throw new Error("Unmodifiable event dispatchers must not be modified")}},removeListener:{value:function(){throw new Error("Unmodifiable event dispatchers must not be modified")}},removeSubscriber:{value:function(){throw new Error("Unmodifiable event dispatchers must not be modified")}},getListeners:{value:function(a){return this.dispatcher.getListeners(a)}},hasListeners:{value:function(a){return this.dispatcher.hasListeners(a)}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.EventSubscriberInterface=function(){},Sy.EventDispatcher.EventSubscriberInterface.prototype=Object.create(Object.prototype,{getSubscribedEvents:{value:function(){}}}),namespace("Sy.EventDispatcher"),Sy.EventDispatcher.GenericEvent=function(a,b){if(Sy.EventDispatcher.Event.call(this),void 0!==b&&!(b instanceof Object))throw new TypeError("Event arguments must be an object");this.subject=a,this.args=b||{}},Sy.EventDispatcher.GenericEvent.prototype=Object.create(Sy.EventDispatcher.Event.prototype,{getSubject:{value:function(){return this.subject}},getArgument:{value:function(a){return this.args[a]}},setArgument:{value:function(a,b){return this.args[a]=b,this}},getArguments:{value:function(){return this.args}},setArguments:{value:function(a){if(!(a instanceof Object))throw new TypeError("Event arguments must be an object");return this.args=a,this}}}),DOM=function(a){return this===window?new DOM(a):void(this.node=a)},DOM.prototype=Object.create(Object.prototype,{isChildOf:{value:function(a,b){return b=b||this.node,a instanceof HTMLElement?a===b?!0:this.isChildOf(a,b.parentNode):"string"==typeof a?this.matches(a)?!0:this.matches(a,b.parentNode):!1}},matches:{value:function(a,b){return b=b||this.node,b.matches&&b.matches(a)?!0:b.webkitMatchesSelector&&b.webkitMatchesSelector(a)?!0:b.mozMatchesSelector&&b.mozMatchesSelector(a)?!0:b.msMatchesSelector&&b.msMatchesSelector(a)?!0:!1}}}),namespace("Sy.View"),Sy.View.LayoutFactoryInterface=function(){},Sy.View.LayoutFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setParser:{value:function(){}},setTemplateEngine:{value:function(){}},setRegistryFactory:{value:function(){}},setListFactory:{value:function(){}},setLayoutWrapper:{value:function(){}}}),namespace("Sy.View"),Sy.View.ListFactoryInterface=function(){},Sy.View.ListFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setTemplateEngine:{value:function(){}},setRegistry:{value:function(){}},setListWrapper:{value:function(){}}}),namespace("Sy.View"),Sy.View.TemplateEngineInterface=function(){},Sy.View.TemplateEngineInterface.prototype=Object.create(Object.prototype,{PATTERN:{value:new RegExp(/{{\s?([\w.]+)\s?}}/gim),writable:!1,configurable:!1},render:{value:function(){}}}),namespace("Sy.View"),Sy.View.ViewScreenFactoryInterface=function(){},Sy.View.ViewScreenFactoryInterface.prototype=Object.create(Sy.FactoryInterface.prototype,{setParser:{value:function(){}},setTemplateEngine:{value:function(){}},setRegistryFactory:{value:function(){}},setLayoutFactory:{value:function(){}},setViewScreenWrapper:{value:function(){}}}),namespace("Sy.View.Event"),Sy.View.Event.ViewPortEvent=function(a){if(!(a instanceof Sy.View.ViewScreen))throw new TypeError("Invalid viewscreen");this.viewscreen=a},Sy.View.Event.ViewPortEvent.prototype=Object.create(Sy.EventDispatcher.Event.prototype,{PRE_DISPLAY:{value:"view::on::pre::display",writable:!1},POST_DISPLAY:{value:"view::on::post::display",writable:!1},getViewScreen:{value:function(){return this.viewscreen}}}),namespace("Sy.View"),Sy.View.NodeWrapper=function(){this.engine=null,this.node=null},Sy.View.NodeWrapper.prototype=Object.create(Object.prototype,{setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setNode:{value:function(a){if(!(a instanceof HTMLElement))throw new TypeError("Invalid dom node");return this.node=a,this}},getNode:{value:function(){return this.node}},render:{value:function(a){return this.engine.render(this.node,a),this}},findOne:{value:function(a){return this.node.querySelector(a)}},find:{value:function(a){return this.node.querySelectorAll(a)}}}),namespace("Sy.View"),Sy.View.Layout=function(){Sy.View.NodeWrapper.call(this),this.name=null,this.lists=null,this.parser=null,this.listFactory=null,this.screen=null},Sy.View.Layout.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b,c;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syLayout,b=this.parser.getLists(a);for(var d=0,e=b.length;e>d;d++)c=this.listFactory.make(this.screen,this.name,b[d]),this.lists.set(c.getName(),c);return this}},setViewScreenName:{value:function(a){return this.screen=a,this}},getName:{value:function(){return this.name}},setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setListsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.lists=a,this}},setListFactory:{value:function(a){if(!(a instanceof Sy.View.ListFactoryInterface))throw new TypeError("Invalid list factory");return this.listFactory=a,this}},getLists:{value:function(){return this.lists.get()}},getList:{value:function(a){return this.lists.get(a)}},render:{value:function(a){return this.engine.render(this.node,a,"[data-sy-list]"),this}}}),namespace("Sy.View"),Sy.View.LayoutFactory=function(){this.parser=null,this.engine=null,this.registryFactory=null,this.listFactory=null,this.layouts=null},Sy.View.LayoutFactory.prototype=Object.create(Sy.View.LayoutFactoryInterface.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistryFactory:{value:function(a){if(!(a instanceof Sy.RegistryFactory))throw new TypeError("Invalid registry factory");return this.registryFactory=a,this.layouts=a.make(),this}},setListFactory:{value:function(a){if(!(a instanceof Sy.View.ListFactoryInterface))throw new TypeError("Invalid list factory");return this.listFactory=a,this}},setLayoutWrapper:{value:function(a,b,c){var d=a+"::"+b;if(this.layouts.has(d))throw new ReferenceError('A layout wrapper is already defined with the name "'+d+'"');if(!(c instanceof Sy.View.Layout))throw new TypeError("Invalid layout wrapper");return this.layouts.set(d,c),this}},make:{value:function(a,b){var c,d=a+"::"+b.dataset.syLayout;return c=this.layouts.has(d)?this.layouts.get(d):new Sy.View.Layout,c.setViewScreenName(a).setParser(this.parser).setListFactory(this.listFactory).setListsRegistry(this.registryFactory.make()).setTemplateEngine(this.engine).setNode(b)}}}),namespace("Sy.View"),Sy.View.List=function(){Sy.View.NodeWrapper.call(this),this.name=null,this.elements=[],this.types=[],this.screen=null,this.layout=null},Sy.View.List.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syList;for(var c=0,d=a.childElementCount;d>c;c++){if(b=a.firstElementChild,this.elements.push(b),a.removeChild(b),this.elements.length>1&&void 0===b.dataset.type)throw new SyntaxError("Multiple list elements require a type to be set");if(void 0!==b.dataset.type){if(-1!==this.types.indexOf(b.dataset.type))throw new SyntaxError("Multiple list elements defined with the same type");this.types.push(b.dataset.type)}}return this}},setViewScreenName:{value:function(a){return this.screen=a,this}},setLayoutName:{value:function(a){return this.layout=a,this}},getName:{value:function(){return this.name}},renderElement:{value:function(a,b){var c,d=b?this.types.indexOf(b):0;if(-1===d)throw new ReferenceError('The type "'+b+'" does not exist for the list "'+this.getName()+'"');return c=window.HTMLTemplateElement&&this.elements[d]instanceof HTMLTemplateElement?document.importNode(this.elements[d].content,!0):this.elements[d].cloneNode(!0),this.engine.render(c,a)}},append:{value:function(a,b){return this.getNode().appendChild(this.renderElement(a,b)),this}},prepend:{value:function(a,b){return this.getNode().insertBefore(this.renderElement(a,b),this.getNode().firstElementChild),this}},render:{value:function(a){for(var b,c,d=this.getNode();d.firstElementChild;)d.removeChild(d.firstElementChild);for(var e=0,f=a.length;f>e;e++)b=a[e],c=b._type,this.append(b,c);return this}}}),namespace("Sy.View"),Sy.View.ListFactory=function(){this.engine=null,this.lists=null},Sy.View.ListFactory.prototype=Object.create(Sy.View.ListFactoryInterface.prototype,{setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.lists=a,this}},setListWrapper:{value:function(a,b,c,d){var e=a+"::"+b+"::"+c;if(this.lists.has(e))throw new ReferenceError('A list wrapper is already defined with the name "'+e+'"');if(!(d instanceof Sy.View.List))throw new TypeError("Invalid list wrapper");return this.lists.set(e,d),this}},make:{value:function(a,b,c){var d,e=a+"::"+b+"::"+c.dataset.syList;return d=this.lists.has(e)?this.lists.get(e):new Sy.View.List,d.setViewScreenName(a).setLayoutName(b).setTemplateEngine(this.engine).setNode(c)}}}),namespace("Sy.View"),Sy.View.Manager=function(){this.views=null,this.factory=null},Sy.View.Manager.prototype=Object.create(Object.prototype,{setViewsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.views=a,this}},setViewScreenFactory:{value:function(a){if(!(a instanceof Sy.View.ViewScreenFactoryInterface))throw new TypeError("Invalid factory");return this.factory=a,this}},setViewScreen:{value:function(a){if(!(a instanceof HTMLElement))throw new TypeError("Html node expected");var b=a.dataset.syView;if(!b&&""===b.trim())throw new SyntaxError('Attribute "data-sy-view" is expected');if(this.views.has(b.trim()))throw new ReferenceError('A view with the name "'+b.trim()+'" already exist');return this.views.set(b.trim(),this.factory.make(a)),this}},getViewScreen:{value:function(a){if(!this.views.has(a))throw new ReferenceError('The view screen "'+a+'" is not registered');return this.views.get(a)}},getViewScreens:{value:function(){return this.views.get()}}}),namespace("Sy.View"),Sy.View.ManagerConfigurator=function(){this.parser=null},Sy.View.ManagerConfigurator.prototype=Object.create(Object.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");this.parser=a}},configure:{value:function(a){if(!(a instanceof Sy.View.Manager))throw new TypeError("Invalid manager");for(var b=this.parser.getViewScreens(),c=0,d=b.length;d>c;c++)a.setViewScreen(b[c]),DOM(b[c]).isChildOf(".viewport")||b[c].parentNode.removeChild(b[c])}}}),namespace("Sy.View"),Sy.View.Parser=function(){},Sy.View.Parser.prototype=Object.create(Object.prototype,{get:{value:function(a,b){return b=b||document.body,b.querySelectorAll(a)}},getViewScreens:{value:function(a){return this.get("[data-sy-view]",a)}},getLayouts:{value:function(a){return this.get("[data-sy-layout]",a)}},getLists:{value:function(a){return this.get("[data-sy-list]",a)}}}),namespace("Sy.View"),Sy.View.TemplateEngine=function(){Sy.View.TemplateEngineInterface.call(this),this.registry=null,this.generator=null},Sy.View.TemplateEngine.prototype=Object.create(Sy.View.TemplateEngineInterface.prototype,{setRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.registry=a,this}},setGenerator:{value:function(a){if(!(a instanceof Sy.Lib.Generator.Interface))throw new TypeError("Invalid generator");return this.generator=a,this}},render:{value:function(a,b,c){if(a instanceof DocumentFragment||(a.dataset.syUuid||this.register(a),a.dataset.syUuid&&this.registry.has(a.dataset.syUuid)&&(this.renderAllAttributes(a,b),this.renderContent(a,b,c))),a.childElementCount>0)for(var d=0,e=a.childElementCount;e>d;d++)this.render(a.children[d],b,c);return a}},register:{value:function(a){for(var b=this.generator.generate(),c={attributes:{},textContent:null,uuid:b},d=0,e=a.attributes.length;e>d;d++)c.attributes[a.attributes[d].name]=a.getAttribute(a.attributes[d].name);return c.textContent=a.textContent,a.dataset.syUuid=b,this.registry.set(b,c),this}},renderAllAttributes:{value:function(a,b){for(var c=0,d=a.attributes.length;d>c;c++)this.renderAttribute(a,a.attributes[c].name,b);return a}},renderAttribute:{value:function(a,b,c){var d,e=a.dataset.syUuid,f=this.registry.get(e).attributes[b];return f?(d=this.replace(f,c),a.setAttribute(b,d),a):a}},replace:{value:function(a,b){for(;a.match(this.PATTERN);){var c=this.PATTERN.exec(a);null!==c&&c.length>=1&&(a=a.replace(c[0],reflectedObjectGetter.call(b,c[1])||""))}return a}},renderContent:{value:function(a,b,c){if(a.childElementCount>0)return a;if(c&&DOM(a).matches(c))return a;var d,e=a.dataset.syUuid,f=this.registry.get(e).textContent,g=this.PATTERN.exec(f);return g&&(d=objectGetter.call(b,g[1])),d instanceof HTMLElement?(a.removeChild(a.firstElementChild),a.appendChild(d)):a.textContent=this.replace(f,b),a}}}),namespace("Sy.View"),Sy.View.ViewPort=function(){this.node=null,this.manager=null,this.dispatcher=null,this.current=null},Sy.View.ViewPort.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setDispatcher:{value:function(a){if(!(a instanceof Sy.EventDispatcher.EventDispatcherInterface))throw new TypeError("Invalid event dispatcher");return this.dispatcher=a,this}},setNode:{value:function(a){if(!(a instanceof HTMLElement&&a.classList.contains("viewport")))throw new TypeError("Invalid node");return this.node=a,this}},setViewManager:{value:function(a){if(!(a instanceof Sy.View.Manager))throw new TypeError("Invalid manager");return this.manager=a,this}},getViewManager:{value:function(){return this.manager}},getCurrentViewScreen:{value:function(){return null===this.current&&1===this.node.childElementCount&&(this.current=this.manager.getViewScreen(this.node.firstElementChild.dataset.syView)),this.current}},display:{value:function(a){var b=this.manager.getViewScreen(a),c=b.getNode(),d=new Sy.View.Event.ViewPortEvent(b);switch(this.dispatcher&&this.dispatcher.dispatch(d.PRE_DISPLAY,d),this.node.childElementCount){case 0:this.node.appendChild(c);break;case 1:this.node.replaceChild(c,this.node.children[0]);break;default:throw new Error("Viewport in weird state (more than 1 child)")}return this.current=b,this.dispatcher&&(d=new Sy.View.Event.ViewPortEvent(b),this.dispatcher.dispatch(d.POST_DISPLAY,d)),this}}}),namespace("Sy.View"),Sy.View.ViewScreen=function(){Sy.View.NodeWrapper.call(this),this.name="",this.parser=null,this.layouts=null,this.layoutFactory=null},Sy.View.ViewScreen.prototype=Object.create(Sy.View.NodeWrapper.prototype,{setNode:{value:function(a){var b,c;Sy.View.NodeWrapper.prototype.setNode.call(this,a),this.name=a.dataset.syView,b=this.parser.getLayouts(a);for(var d=0,e=b.length;e>d;d++)c=this.layoutFactory.make(this.name,b[d]),this.layouts.set(c.getName(),c);return this}},getName:{value:function(){return this.name}},setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setLayoutsRegistry:{value:function(a){if(!(a instanceof Sy.RegistryInterface))throw new TypeError("Invalid registry");return this.layouts=a,this}},setLayoutFactory:{value:function(a){if(!(a instanceof Sy.View.LayoutFactoryInterface))throw new TypeError("Invalid layout factory");return this.layoutFactory=a,this}},getLayouts:{value:function(){return this.layouts.get()}},getLayout:{value:function(a){return this.layouts.get(a)}},render:{value:function(a){return this.engine.render(this.node,a,"[data-sy-list]"),this}}}),namespace("Sy.View"),Sy.View.ViewScreenFactory=function(){this.parser=null,this.engine=null,this.registryFactory=null,this.layoutFactory=null,this.viewscreens=null},Sy.View.ViewScreenFactory.prototype=Object.create(Sy.View.ViewScreenFactoryInterface.prototype,{setParser:{value:function(a){if(!(a instanceof Sy.View.Parser))throw new TypeError("Invalid parser");return this.parser=a,this}},setTemplateEngine:{value:function(a){if(!(a instanceof Sy.View.TemplateEngineInterface))throw new TypeError("Invalid template engine");return this.engine=a,this}},setRegistryFactory:{value:function(a){if(!(a instanceof Sy.RegistryFactory))throw new TypeError("Invalid registry factory");return this.registryFactory=a,this.viewscreens=a.make(),this}},setLayoutFactory:{value:function(a){if(!(a instanceof Sy.View.LayoutFactoryInterface))throw new TypeError("Invalid layout factory");return this.layoutFactory=a,this}},setViewScreenWrapper:{value:function(a,b){if(this.viewscreens.has(a))throw new ReferenceError('A viewscreen wrapper is already defined with the name "'+a+'"');if(!(b instanceof Sy.View.ViewScreen))throw new TypeError("Invalid viewscreen wrapper");return this.viewscreens.set(a,b),this}},make:{value:function(a){var b,c=a.dataset.syView;return b=this.viewscreens.has(c)?this.viewscreens.get(c):new Sy.View.ViewScreen,b.setParser(this.parser).setLayoutFactory(this.layoutFactory).setLayoutsRegistry(this.registryFactory.make()).setTemplateEngine(this.engine).setNode(a)}}});